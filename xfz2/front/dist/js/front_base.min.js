function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disabled");var n=10;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码！"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){a.hideEvent(),window.location.reload()}})})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),a=m.find("input[name='img_captcha']"),s=m.find("input[name='password1']"),i=m.find("input[name='password2']"),o=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=a.val(),u=s.val(),l=i.val(),h=o.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){window.location.reload()}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/60/60),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGEiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwibGlzdGVuU2hvd0hpZGVFdmVudCIsImxpc3RlblN3aXRjaEV2ZW50IiwibGlzdGVuU2lnbmluRXZlbnQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TbXNDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TaWdudXBFdmVudCIsInNob3dFdmVudCIsImhpZGVFdmVudCIsInNtc1N1Y2Nlc3NFdmVudCIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJpbWdDYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJ0ZWxlcGhvbmVJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInNob3dJbmZvIiwieGZ6YWpheCIsImdldCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0IiwiZmFpbCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsInNpZ25pbkdyb3VwIiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJwb3N0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJzaWdudXBHcm91cCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VybmFtZUlucHV0IiwiaW1nQ2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc0NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiXSwibWFwcGluZ3MiOiJBQUVBLFNBQVNBLGFBc0JULFNBQVNDLE9BQ0wsSUFBSUMsRUFBT0MsS0FDWEQsRUFBS0UsWUFBY0MsRUFBRSxpQkFDckJILEVBQUtJLGNBQWdCRCxFQUFFLG1CQUN2QkgsRUFBS0ssV0FBYUYsRUFBRSxvQkFyQnhCTCxVQUFVUSxVQUFVQyxJQUFNLFdBQ1hOLEtBQ05PLHNCQUdUVixVQUFVUSxVQUFVRSxtQkFBcUIsV0FDckMsSUFBSUMsRUFBVU4sRUFBRSxhQUNaTyxFQUFjUCxFQUFFLGtCQUNwQk0sRUFBUUUsTUFBTSxXQUNWRCxFQUFZRSxRQUNkLFdBQ0VGLEVBQVlHLFVBYXBCZCxLQUFLTyxVQUFVQyxJQUFNLFdBQ2pCLElBQUlQLEVBQU9DLEtBQ1hELEVBQUtjLHNCQUNMZCxFQUFLZSxvQkFDTGYsRUFBS2dCLG9CQUNMaEIsRUFBS2lCLHdCQUNMakIsRUFBS2tCLHdCQUNMbEIsRUFBS21CLHFCQUdUcEIsS0FBS08sVUFBVWMsVUFBWSxXQUNabkIsS0FDTkMsWUFBWVUsUUFHckJiLEtBQUtPLFVBQVVlLFVBQVksV0FDWnBCLEtBQ05DLFlBQVlXLFFBR3JCZCxLQUFLTyxVQUFVZ0IsZ0JBQWtCLFdBQzdCLElBQUl0QixFQUFPQyxLQUNYc0IsV0FBV0MsWUFBWSxj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TCxFQUFnQjNCLE1BQzlCaUMsRUFBWUwsRUFBZTVCLE1BQzNCa0MsRUFBWUwsRUFBZTdCLE1BQzNCbUMsRUFBY0wsRUFBZ0I5QixNQUVsQ0UsUUFBUWlCLEtBQUssQ0FDVGYsSUFBTyxxQkFDUEMsS0FBUSxDQUNKTixVQUFhQSxFQUNiZ0MsU0FBWUEsRUFDWkMsWUFBZUEsRUFDZkMsVUFBYUEsRUFDYkMsVUFBYUEsRUFDYkMsWUFBZUEsR0FFbkI3QixRQUFXLFNBQVVDLEdBQ2pCYSxPQUFPQyxTQUFTQyxlQU9oQ25FLEVBQUUsWUFDYSxJQUFJSixNQUNWUSxRQUlUSixFQUFFLFlBQ2tCLElBQUlMLFdBQ1ZTLFFBR2RKLEVBQUUsV0FDS2lFLE9BQU9nQixXQUNOQSxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBQzVDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVNGLEVBQUtHLFVBRWRDLElBRFEsSUFBS0gsTUFBUUUsVUFDQUQsR0FBUSxJQUNqQyxPQUFHRSxFQUFZLEdBQ0osS0FFVSxJQUFiQSxHQUFtQkEsRUFBWSxNQUNuQ0MsUUFBVXRELFNBQVNxRCxFQUFZLElBQ3hCQyxRQUFRLE9BRUUsTUFBYkQsR0FBc0JBLEVBQVksT0FDdENFLE1BQVF2RCxTQUFTcUQsRUFBWSxHQUFLLElBQzNCRSxNQUFNLE9BRUksT0FBYkYsR0FBeUJBLEVBQVksUUFDekNHLEtBQU94RCxTQUFTcUQsRUFBWSxHQUFLLEdBQUssSUFDL0JHLEtBQU8sTUFFSFAsRUFBS1EsY0FLSixJQUpBUixFQUFLUyxXQUlLLElBSFpULEVBQUtVLFNBR2UsSUFGbkJWLEVBQUtXLFdBRXVCLElBRDFCWCxFQUFLWSIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuLy8g55So5p2l5aSE55CG5a+86Iiq5p2h55qEXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XG5cbn1cblxuXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5saXN0ZW5BdXRoQm94SG92ZXIoKTtcbn07XG5cbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuQXV0aEJveEhvdmVyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhdXRoQm94ID0gJChcIi5hdXRoLWJveFwiKTtcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKTtcbiAgICB9LGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpO1xuICAgIH0pO1xufTtcblxuXG4vLyDnlKjmnaXlpITnkIbnmbvlvZXlkozms6jlhoznmoRcbmZ1bmN0aW9uIEF1dGgoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYubWFza1dyYXBwZXIgPSAkKCcubWFzay13cmFwcGVyJyk7XG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcbiAgICBzZWxmLnNtc0NhcHRjaGEgPSAkKCcuc21zLWNhcHRjaGEtYnRuJyk7XG59XG5cbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XG4gICAgc2VsZi5saXN0ZW5Td2l0Y2hFdmVudCgpO1xuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xuICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XG4gICAgc2VsZi5saXN0ZW5TaWdudXBFdmVudCgpO1xufTtcblxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5tYXNrV3JhcHBlci5oaWRlKCk7XG59O1xuXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oemqjOivgeeggeWPkemAgeaIkOWKn++8gScpO1xuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB2YXIgY291bnQgPSAxMDtcbiAgICBzZWxmLnNtc0NhcHRjaGEudW5iaW5kKCdjbGljaycpO1xuICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQrJ3MnKTtcbiAgICAgICAgY291bnQgLT0gMTtcbiAgICAgICAgaWYoY291bnQgPD0gMCl7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KCflj5HpgIHpqozor4HnoIEnKTtcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XG4gICAgICAgIH1cbiAgICB9LDEwMDApO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2hvd0hpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHNpZ25pbkJ0biA9ICQoJy5zaWduaW4tYnRuJyk7XG4gICAgdmFyIHNpZ251cEJ0biA9ICQoJy5zaWdudXAtYnRuJyk7XG4gICAgdmFyIGNsb3NlQnRuID0gJCgnLmNsb3NlLWJ0bicpO1xuXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6MH0pO1xuICAgIH0pO1xuXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6LTQwMH0pO1xuICAgIH0pO1xuXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzd2l0Y2hlciA9ICQoXCIuc3dpdGNoXCIpO1xuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XG4gICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xuICAgICAgICBpZihjdXJyZW50TGVmdCA8IDApe1xuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOicwJ30pO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjpcIi00MDBweFwifSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlbkltZ0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW1nQ2FwdGNoYSA9ICQoJy5pbWctY2FwdGNoYScpO1xuICAgIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpbWdDYXB0Y2hhLmF0dHIoXCJzcmNcIixcIi9hY2NvdW50L2ltZ19jYXB0Y2hhL1wiK1wiP3JhbmRvbT1cIitNYXRoLnJhbmRvbSgpKVxuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xuICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG4gICAgICAgIGlmKCF0ZWxlcGhvbmUpe1xuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6K+36L6T5YWl5omL5py65Y+356CB77yBJyk7XG4gICAgICAgIH1cbiAgICAgICAgeGZ6YWpheC5nZXQoe1xuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxuICAgICAgICAgICAgJ2RhdGEnOntcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT0gMjAwKXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbmluRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKTtcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcbiAgICB2YXIgcmVtZW1iZXJJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdyZW1lbWJlciddXCIpO1xuXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciByZW1lbWJlciA9IHJlbWVtYmVySW5wdXQucHJvcChcImNoZWNrZWRcIik7XG5cbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcbiAgICAgICAgICAgICdkYXRhJzoge1xuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXI/MTowXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJyk7XG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zX2NhcHRjaGEnXVwiKTtcblxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBpbWdfY2FwdGNoYSA9IGltZ0NhcHRjaGFJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQyID0gcGFzc3dvcmQySW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc0NhcHRjaGFJbnB1dC52YWwoKTtcblxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxuICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZDInOiBwYXNzd29yZDIsXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XG4gICAgYXV0aC5ydW4oKTtcbn0pO1xuXG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XG4gICAgZnJvbnRCYXNlLnJ1bigpO1xufSk7XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIGlmKHdpbmRvdy50ZW1wbGF0ZSl7XG4gICAgICAgIHRlbXBsYXRlLmRlZmF1bHRzLmltcG9ydHMudGltZVNpbmNlID0gZnVuY3Rpb24gKGRhdGVWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xuICAgICAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpOyAvLyDlvpfliLDnmoTmmK/mr6vnp5LnmoRcbiAgICAgICAgICAgIHZhciBub3d0cyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7IC8v5b6X5Yiw55qE5piv5b2T5YmN5pe26Ze055qE5pe26Ze05oizXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKS8xMDAwOyAvLyDpmaTku6UxMDAw77yM5b6X5Yiw55qE5piv56eSXG4gICAgICAgICAgICBpZih0aW1lc3RhbXAgPCA2MCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAn5Yia5YiaJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKSB7XG4gICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGltZXN0YW1wID49IDYwKjYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKjI0KSB7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91cnMrJ+Wwj+aXtuWJjSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xuICAgICAgICAgICAgICAgIGRheXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwIC8gMjQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXlzICsgJ+WkqeWJjSc7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XG4gICAgICAgICAgICAgICAgdmFyIGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5K1wiIFwiK2hvdXIrXCI6XCIrbWludXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7Il19
